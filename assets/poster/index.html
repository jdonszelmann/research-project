<html id="html">
    <head>
        <meta charset="UTF-8">
        <link rel="stylesheet" href="css/desktop.css">
        <link rel="stylesheet" href="css/phone.css">
        <link rel="stylesheet" href="css/columns.css">
        <link rel="stylesheet" href="css/poster.css">
        <link rel="stylesheet" href="css/presentation.css">

        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        <title>Document</title>

        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <script src="js/dom-to-image.js"></script>
        <script src="js/pres_mode.js"></script>
    </head>

    <body id="body">

        <div id="state0">
            Matching in Multi Agent Pathfinding using M*
        </div>

        <div id="content">
            <div class="mobile_only" style="text-align: center;">
                <p>
                    <mark>Click images to start animation.</mark>
                </p>
            </div>

            <div class="content-item" id="state1">
                <h1 class="column-title">Pathfinding</h1>


                <div class="twocolimg poster_only">

                    <figure>
                        <img src="assets/pathfinding_start.png" class="mapf-image">
                        <figcaption>A start state</figcaption>
                    </figure>
                    <figure>
                        <img src="assets/pathfinding_end.png" class="mapf-image">
                        <figcaption>A path that is found</figcaption>
                    </figure>
                </div>
                <div class="web_only gif">
                    <figure>
                        <img src="assets/pathfinding.gif" class="mapf-image dynamic">
                        <img src="assets/pathfinding-static.png" class="mapf-image static">
                        <figcaption>Pathfinding on a grid</figcaption>
                    </figure>
                </div>

                <p>
                    <mark>Pathfinding</mark> is the process of searching for a route from a start to a goal.
                    The shortest path possible needs to be found.
                </p>

                <h2 class="column-title">Multi agent pathfinding</h2>

                <div class="threecolimg poster_only">
                    <figure>
                        <img src="assets/multi_agent_pathfinding_start.png" class="mapf-image">
                        <figcaption>A start state</figcaption>
                    </figure>
                    <figure>
                        <img src="assets/multi_agent_pathfinding_end.png" class="mapf-image">
                        <figcaption>A goal state</figcaption>
                    </figure>
                    <figure>
                        <img src="assets/multi_agent_pathfinding_illegal.png" class="mapf-image redborder">
                        <figcaption>An illegal action</figcaption>
                    </figure>
                </div>
                <div class="twocolimg web_only">
                    <figure>
                        <div class="gif">
                            <img src="assets/multi-agent-pathfinding.gif" class="mapf-image dynamic">
                            <img src="assets/multi-agent-pathfinding-static.png" class="mapf-image static">
                            <figcaption>A solution to MAPF</figcaption>
                        </div>
                    </figure>

                    <figure>
                        <div class="gif" style="width: 100%">
                            <img src="assets/multi-agent-pathfinding-illegal.gif" class="dynamic redborder">
                            <img src="assets/multi-agent-pathfinding-illegal-static.png" class="static redborder">
                        </div>
                        <figcaption>An invalid solution to MAPF</figcaption>
                    </figure>
                </div>

                <div>
                    <p>
                        <mark>Multi agent pathfinding</mark> (MAPF) is pathfinding for multiple robots simultaneously.
                        Robots <mark>must not collide</mark> (see red example).
                    </p>

                    <p>
                        The <mark>sum of costs</mark> for all agents needs to be minimized.
                    </p>
                </div>

                <div id="interactive-version" class="poster_only">
                    An interactive version of this poster can be found at <a>https://midterm-poster.jdonszelmann.nl</a>
                </div>

                <div id="online-version" style="display: none">
                    This poster can be found at <a>https://midterm-poster.jdonszelmann.nl</a>
                </div>

            </div>
            <div class="content-item" id="state2">
                <h1 class="column-title">Matching</h1>

                <p>
                    A <mark>matching</mark> is a set of connections between two parts of a graph.
                    A node in one part of the graph can only be connected to one node in the other part.
                </p>

                <figure class="web_only">
                    <div class="gif">
                        <img src="assets/matchings.gif" class="mapf-image dynamic">
                        <img src="assets/matchings-static.png" class="mapf-image static">
                        <figcaption>All matchings between two sets of 4 nodes</figcaption>
                    </div>
                </figure>

                <div class="twocolimg poster_only">
                    <figure>
                        <img src="assets/matchings-one.png" class="mapf-image">
                        <figcaption>A trivial matching</figcaption>
                    </figure>
                    <figure>
                        <img src="assets/matchings-two.png" class="mapf-image">
                        <figcaption>A more complex matching</figcaption>
                    </figure>
                </div>

                <p>
                    MAPF with matching can be though of as MAPF with teams. Each team has starts and goals
                    (indicated by having the same colour).
                </p>

                <div class="twocolimg web_only">
                    <figure>
                        <div class="gif">
                            <img src="assets/MAPF-matching-long.gif" class="mapf-image dynamic">
                            <img src="assets/mapf-matching-two.png" class="mapf-image static">
                            <figcaption>A possible matching</figcaption>
                        </div>
                    </figure>

                    <figure>
                        <div class="gif" style="width: 100%">
                            <img src="assets/MAPF-matching-short.gif" class="dynamic">
                            <img src="assets/mapf-matching-one.png" class="static">
                        </div>
                        <figcaption>Another, shorter, matching</figcaption>
                    </figure>
                </div>
                <div class="twocolimg poster_only">

                    <figure>
                        <img src="assets/mapf-matching-two.png" class="mapf-image">
                        <figcaption>A possible matching</figcaption>
                    </figure>
                    <figure>
                        <img src="assets/mapf-matching-one.png" class="mapf-image">
                        <figcaption>Another, shorter, matching</figcaption>
                    </figure>
                </div>

                <p>
                    A minimal cost matching needs to be found.
                </p>

                <figure class="web_only">
                    <div class="gif">
                        <img src="assets/multiple-teams.gif" class="mapf-image dynamic">
                        <img src="assets/multiple-teams-static.png" class="mapf-image static">
                        <figcaption>There can be multiple teams</figcaption>
                    </div>
                </figure>

                <figure class="poster_only">
                    <img src="assets/multiple-teams-static.png" class="mapf-image">
                    <figcaption>There can be multiple teams</figcaption>
                </figure>
            </div>
            <div class="content-item" id="state3">
                <h1 class="column-title">M*</h1>

                <p>
                    <mark>M*</mark> is an algorithm solving MAPF.
                    M* tries to convert MAPF to single agent pathfinding wherever this is possible.
                </p>

                <div class="presentation_only">
                    M* tries to convert MAPF to single agent pathfinding wherever this is possible.
                </div>

                <figure class="web_only">
                    <div class="gif">
                        <img src="assets/individual-optimality.gif" class="mapf-image dynamic">
                        <img src="assets/individual-optimality-static.png" class="mapf-image static">
                        <figcaption>Agents can plan their plan independently</figcaption>
                    </div>
                </figure>

                <figure class="poster_only">
                    <img src="assets/individual-optimality-static.png" class="mapf-image">
                    <figcaption>Agents can plan their path independently</figcaption>
                </figure>

                <p>
                    When collisions do occur, paths are planned together around the collision area.
                </p>

                <p>
                    With <mark>Operator decomposition</mark>, states can be partially explored for just one of the multiple agents.
                    This can improve performance.
                </p>

                <div class="presentation_only">
                    <mark>Operator decomposition</mark>: partially explore states
                </div>

                <h2>Matching in M*</h2>

                <p>
                    Two strategies: <mark>Inmatch</mark> en <mark>Prematch</mark> are proposed to add matching to M*.
                    Prematch seems to outperform Inmatch in many cases.
                </p>

                <div class="twocolimg graphs">
                    <figure>
                        <img src="assets/graph_2n.png" class="mapf-image">
                    </figure>
                    <figure>
                        <img src="assets/graph_1n.png" class="mapf-image">
                    </figure>
                </div>
                <p>
                    Matching performance of a growing number of agents in a single team.
                    Percentage solved out of 1000 runs.
                </p>
                <h2>Conclusion</h2>
                <p>
                    M* outperforms naive A* in matching, OD can additionally improve
                    performance on maps that are relatively open. More experiments need to be
                    done to draw final conclusions, like a comparison to other algorithms.

                </p>
            </div>
        </div>
        <div id="controls">
            <div id=download_button onclick="do_print()">Download poster</div>

            <span class="control-elem" id="project">Matching in Multi Agent Pathfinding using M*</span>

            <div id="separator"></div>
            <span class="control-elem no-mobile-only" id="tu">TU Delft</span>
            <span class="control-elem no-mobile-only">Jesse Mulderij</span>
            <span class="control-elem no-mobile-only">Mathijs de Weerdt</span>

            <span class="control-elem" id="name">
                <div class="web_only">
                Jonathan Dönszelmann
                </div>
                <a class="web_only" href="mailto:jdonszelmann@student.tudelft.nl">jdonszelmann@student.tudelft.nl</a>
                <span class="poster_only">
                    Jonathan Dönszelmann <a>jdonszelmann@student.tudelft.nl</a>
                </span>
            </span>
        </div>

        <script>
            function mobileCheck() {
              return window.innerWidth < window.innerHeight;
            }

            function resize() {
                if (mobileCheck()) {
                    document.getElementById("html").classList.add("mobile");
                } else {
                    document.getElementById("html").classList.remove("mobile");
                }
            }
            window.addEventListener("resize", resize);
            resize();

            async function do_print() {
                const body = document.getElementById("body");
                document.getElementById("html").classList.remove("mobile");

                body.classList.add("poster")

                const dataUrl = await domtoimage.toPng(body)

                body.classList.remove("poster")

                const link = document.createElement('a');
                link.download = 'poster.png';
                link.href = dataUrl;
                link.click();

                resize();
            }

            // window.onload = function () {
            //     const elems = document.getElementsByClassName("gif");
            //     for (let i = 0; i < elems.length; i++) {
            //         elems[i].addEventListener("mouseover", function () {
            //             const imgs = elems[i].getElementsByTagName("img")
            //             for (let j = 0; j < imgs.length; j++) {
            //                 const img = imgs[j]
            //                 img.src = img.src.replace(/\?.*$/,"")+"?x="+Math.random();
            //             }
            //         })
            //     }
            // }
        </script>
    </body>
</html>


